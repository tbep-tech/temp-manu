<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.533">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GAM exploration</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="gam_exploration_files/libs/clipboard/clipboard.min.js"></script>
<script src="gam_exploration_files/libs/quarto-html/quarto.js"></script>
<script src="gam_exploration_files/libs/quarto-html/popper.min.js"></script>
<script src="gam_exploration_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="gam_exploration_files/libs/quarto-html/anchor.min.js"></script>
<link href="gam_exploration_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="gam_exploration_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="gam_exploration_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="gam_exploration_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="gam_exploration_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="gam_exploration_files/libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="gam_exploration_files/libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="gam_exploration_files/libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#quick-summary" id="toc-quick-summary" class="nav-link active" data-scroll-target="#quick-summary">Quick summary</a></li>
  <li><a href="#epc" id="toc-epc" class="nav-link" data-scroll-target="#epc">EPC</a>
  <ul class="collapse">
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul></li>
  <li><a href="#fim" id="toc-fim" class="nav-link" data-scroll-target="#fim">FIM</a>
  <ul class="collapse">
  <li><a href="#conclusions-1" id="toc-conclusions-1" class="nav-link" data-scroll-target="#conclusions-1">Conclusions</a></li>
  </ul></li>
  <li><a href="#pdem" id="toc-pdem" class="nav-link" data-scroll-target="#pdem">PDEM</a>
  <ul class="collapse">
  <li><a href="#conclusions-2" id="toc-conclusions-2" class="nav-link" data-scroll-target="#conclusions-2">Conclusions</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">GAM exploration</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gratia)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'R/funcs.R'</span>))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">'data/epccmbdat.RData'</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">'data/fimsgtempdat.RData'</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">'data/pincotemp.RData'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The following is an exploratory analysis of potential seagrass response related to time, light attenuation, temperature, and salinity. Three different datasets are used, each with different sampling designs. GAMs are used to assess potential non-linear responses in seagrass change using the sum of additive smoothing functions for different predictors. Lower Tampa Bay is not modeled in any of the models given minimal seagrass loss. Model selection techniques are not considered for simplicity and the results are evaluated based on the percent deviance explained and “partial effects” of each smoother, where the smoother is a proxy for the effect of the variable on the response while considering a more comprehensive set of predictors. These models were developed in response to reviewer comments on including additional predictors important for characterizing change, namely time and light attenuation.</p>
<section id="quick-summary" class="level2">
<h2 class="anchored" data-anchor-id="quick-summary">Quick summary</h2>
<p>All models had much more explained variance (32-94%) compared to earlier linear regression models. The EPC models returned confusing results, which could be from differences in sampling location for water quality (mid-bay) vs seagrass transect sampling. The FIM models for nearshore provide the most compelling results, particularly for temperature in HB and salinity in MTB. There are also some notable differences by season in the FIM models. The PDEM models are inconsistent, although a significant interaction term for temperature and season at stratum E4 (most southern portion of OTB) suggests increasing temperature in the winter is associated with lower seagrass frequency occurrence. In general, trends in OTB are not explained well by temperature or salinity, whereas HB and MTB follow expectations for some of the models.</p>
</section>
<section id="epc" class="level2">
<h2 class="anchored" data-anchor-id="epc">EPC</h2>
<p>The EPC data were compared to bay segment averages of seagrass transect frequency occurrence data at the annual scale. Light attenuation was estimated from all monitoring stations using Secchi depth and combined as a bay segment average, as is done for TBEP reporting to FDEP. Temperature and salinity are expressed as the estimated number of days each year when when temperature was above or salinity was below a threshold, where the expectation is that total frequency occurrence will decrease as both increase. The model formula is as follows:</p>
<p><span class="math display">\[
\begin{aligned}
Freq. Occ. \sim s(year, by = bay\_segment, bs = 'tp') + s(la, by = bay\_segment, bs = 'tp') +
\\
s(temp, by = bay\_segment, bs = 'tp') + s(salinity, by = bay\_segment, bs = 'tp')
\end{aligned}
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tomod <span class="ot">&lt;-</span> epccmbdat <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>bay_segment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'LTB'</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># single smoothers only, temp, sal</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(total <span class="sc">~</span> <span class="fu">s</span>(yr, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(la, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(temp, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(sal, <span class="at">by =</span> bay_segment), <span class="at">data =</span> tomod, <span class="at">method =</span> <span class="st">'REML'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Smoother summary:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">star =</span> <span class="fu">p_ast2</span>(p.value)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">edf</th>
<th style="text-align: right;">ref.df</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: left;">star</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">s(yr):bay_segmentOTB</td>
<td style="text-align: right;">4.847</td>
<td style="text-align: right;">5.781</td>
<td style="text-align: right;">9.896</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(yr):bay_segmentHB</td>
<td style="text-align: right;">4.059</td>
<td style="text-align: right;">4.791</td>
<td style="text-align: right;">3.840</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(yr):bay_segmentMTB</td>
<td style="text-align: right;">4.172</td>
<td style="text-align: right;">5.110</td>
<td style="text-align: right;">11.747</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(la):bay_segmentOTB</td>
<td style="text-align: right;">1.644</td>
<td style="text-align: right;">2.013</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0.897</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(la):bay_segmentHB</td>
<td style="text-align: right;">5.947</td>
<td style="text-align: right;">6.536</td>
<td style="text-align: right;">20.677</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(la):bay_segmentMTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">9.415</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(temp):bay_segmentOTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">2.393</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(temp):bay_segmentHB</td>
<td style="text-align: right;">1.554</td>
<td style="text-align: right;">1.824</td>
<td style="text-align: right;">0.751</td>
<td style="text-align: right;">0.428</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(temp):bay_segmentMTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.907</td>
<td style="text-align: right;">0.346</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(sal):bay_segmentOTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">4.469</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(sal):bay_segmentHB</td>
<td style="text-align: right;">1.817</td>
<td style="text-align: right;">2.156</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">0.959</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(sal):bay_segmentMTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.804</td>
<td style="text-align: right;">0.186</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Model fit summary:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>smmod <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>smtab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">R.sq =</span> smmod<span class="sc">$</span>r.sq,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Deviance explained</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>smmod<span class="sc">$</span>dev.expl, <span class="dv">0</span>), <span class="st">'%'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(smtab, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">'l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">R.sq</th>
<th style="text-align: left;">Deviance explained</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.9</td>
<td style="text-align: left;">94%</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="gam_exploration_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></a></p>
</figure>
</div>
</div>
</div>
<p>The same model is created but the “both” metric is used instead of temperature and salinity, which is the number of days each year when both temperature was above or salinity was below thresholds. The expectation is that total frequency occurrence will decrease as the metric increases, either linearly (additive effect) or non-linearly (multiplicative effect). The model formula is as follows:</p>
<p><span class="math display">\[
\begin{aligned}
Freq. Occ. \sim s(year, by = bay\_segment, bs = 'tp') + s(la, by = bay\_segment, bs = 'tp') +
\\
s(both, by = bay\_segment, bs = 'tp')
\end{aligned}
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># single smoothers only, temp, sal</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(total <span class="sc">~</span> <span class="fu">s</span>(yr, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(la, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(both, <span class="at">by =</span> bay_segment), <span class="at">data =</span> tomod, <span class="at">method =</span> <span class="st">'REML'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Smoother summary:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">star =</span> <span class="fu">p_ast2</span>(p.value)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">edf</th>
<th style="text-align: right;">ref.df</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: left;">star</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">s(yr):bay_segmentOTB</td>
<td style="text-align: right;">4.750</td>
<td style="text-align: right;">5.726</td>
<td style="text-align: right;">9.743</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(yr):bay_segmentHB</td>
<td style="text-align: right;">3.467</td>
<td style="text-align: right;">4.142</td>
<td style="text-align: right;">2.070</td>
<td style="text-align: right;">0.093</td>
<td style="text-align: left;"><span class="math inline">\(^.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(yr):bay_segmentMTB</td>
<td style="text-align: right;">4.369</td>
<td style="text-align: right;">5.348</td>
<td style="text-align: right;">14.765</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(la):bay_segmentOTB</td>
<td style="text-align: right;">1.101</td>
<td style="text-align: right;">1.184</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">0.901</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(la):bay_segmentHB</td>
<td style="text-align: right;">5.828</td>
<td style="text-align: right;">6.440</td>
<td style="text-align: right;">36.448</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(la):bay_segmentMTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">13.356</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(both):bay_segmentOTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">8.396</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(both):bay_segmentHB</td>
<td style="text-align: right;">3.184</td>
<td style="text-align: right;">3.781</td>
<td style="text-align: right;">4.455</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(both):bay_segmentMTB</td>
<td style="text-align: right;">1.304</td>
<td style="text-align: right;">1.528</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.952</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Model fit summary:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>smmod <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>smtab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">R.sq =</span> smmod<span class="sc">$</span>r.sq,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Deviance explained</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>smmod<span class="sc">$</span>dev.expl, <span class="dv">0</span>), <span class="st">'%'</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(smtab, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">'l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">R.sq</th>
<th style="text-align: left;">Deviance explained</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.9</td>
<td style="text-align: left;">94%</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="gam_exploration_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></a></p>
</figure>
</div>
</div>
</div>
<section id="conclusions" class="level3">
<h3 class="anchored" data-anchor-id="conclusions">Conclusions</h3>
<p>There’s some weirdness with these models that don’t align with expectations. For example, increasing light attenuation is associated with increasing seagrass frequency occurrence (MTB). Additionally, increases of the stressor metrics are also often associated with increasing seagrass frequency occurrence. These results could be from a discrepancy between sampling location of the EPC stations and the seagrass transects, i.e., the stations are in deeper water and may not reflect conditions at the seagrass beds in more shallow waters. The association of the salinity metric with seagrasses in MTB is as expected, although the smoother is not significant. However, this is consistent with the FIM models.</p>
</section>
</section>
<section id="fim" class="level2">
<h2 class="anchored" data-anchor-id="fim">FIM</h2>
<p>The FIM models are different from the EPC models in several ways:</p>
<ul>
<li>Seagrass and stressor data are collected at the same locations possibly allowing for a more consistent comparison</li>
<li>The stressor data (light attenuation, temperature, salinity) are observed data, so the expectation of how seagrass will response varies from the EPC data and by stressor, i.e., seagrass will decrease with temperature and light attenuation, but increase with salinity (fresh conditions are more stressful)</li>
<li>Monthly observations are available, allowing a seasonal component in the model.</li>
<li>Secchi data is used for light attenuation (as for EPC), but more than half of the observations are on the bottom. Attempts were made to calculate monthly medians using Kaplan-Meier survival curves, but data were insufficient to do so.</li>
</ul>
<p>The FIM data are averaged at the annual and monthly time steps. The model is more complex than the previous and includes smoothers for year, month, light attenuation, temperature, and salinity and interaction smoothers (<code>ti</code>) for the predictions with month, allowing the effects of the predictors to vary seasonally. Different smoothers are also constructed for each bay segment. The model formula is as follows:</p>
<p><span class="math display">\[
\begin{aligned}
Coverage \sim s(year, by = bay\_segment, bs = 'tp') + s(la, by = bay\_segment, bs = 'tp') +
\\
s(temp, by = bay\_segment, bs = 'tp') + s(salinity, by = bay\_segment, bs = 'tp') +
\\
s(month, bs = 'cc', by = bay\_segment) +
\\
ti(year, month, bs = c('tp', 'cc'), by = bay\_segment) +
\\
ti(la, month, bs = c('tp', 'cc'), by = bay\_segment) +
\\
ti(temp, month, bs = c('tp', 'cc'), by = bay\_segment) +
\\
ti(salinity, month, bs = c('tp', 'cc'), by = bay\_segment)
\end{aligned}
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tomod <span class="ot">&lt;-</span> fimsgtempdat <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>bay_segment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'LTB'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, sgcov, sgpres, yr, temp, sal, secchi_m, secchi_on_bottom, bay_segment) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mo =</span> <span class="fu">month</span>(date)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(month(date) %in% c(6:9)) %&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sgcov =</span> <span class="fu">mean</span>(sgcov),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sgpres =</span> <span class="fu">mean</span>(sgpres),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">mean</span>(temp),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sal =</span> <span class="fu">mean</span>(sal),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">secchi_m =</span> <span class="fu">mean</span>(secchi_m),</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(bay_segment, yr, mo)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">la =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>      bay_segment <span class="sc">%in%</span> <span class="st">"OTB"</span> <span class="sc">~</span> <span class="fl">1.49</span> <span class="sc">/</span> secchi_m,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>      bay_segment <span class="sc">%in%</span> <span class="st">"HB"</span> <span class="sc">~</span> <span class="fl">1.61</span> <span class="sc">/</span> secchi_m,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>      bay_segment <span class="sc">%in%</span> <span class="st">"MTB"</span> <span class="sc">~</span> <span class="fl">1.49</span> <span class="sc">/</span> secchi_m,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>      bay_segment <span class="sc">%in%</span> <span class="st">"LTB"</span> <span class="sc">~</span> <span class="fl">1.84</span> <span class="sc">/</span> secchi_m</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(sgcov <span class="sc">~</span> <span class="fu">s</span>(yr, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(la, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(temp, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(sal, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(mo, <span class="at">bs =</span> <span class="st">'cc'</span>, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">ti</span>(yr, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">ti</span>(la, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">ti</span>(temp, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">ti</span>(sal, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> bay_segment), <span class="at">knots =</span> <span class="fu">list</span>(<span class="at">doy =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">12</span>)), <span class="at">data =</span> tomod, <span class="at">method =</span> <span class="st">'REML'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Smoother summary:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">star =</span> <span class="fu">p_ast2</span>(p.value)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">edf</th>
<th style="text-align: right;">ref.df</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: left;">star</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">s(yr):bay_segmentOTB</td>
<td style="text-align: right;">5.871</td>
<td style="text-align: right;">7.015</td>
<td style="text-align: right;">7.199</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(yr):bay_segmentHB</td>
<td style="text-align: right;">4.425</td>
<td style="text-align: right;">5.419</td>
<td style="text-align: right;">6.198</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(yr):bay_segmentMTB</td>
<td style="text-align: right;">5.924</td>
<td style="text-align: right;">7.046</td>
<td style="text-align: right;">2.378</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(la):bay_segmentOTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(la):bay_segmentHB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">1.902</td>
<td style="text-align: right;">0.168</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(la):bay_segmentMTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.625</td>
<td style="text-align: right;">0.203</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(temp):bay_segmentOTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">1.177</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(temp):bay_segmentHB</td>
<td style="text-align: right;">4.460</td>
<td style="text-align: right;">5.462</td>
<td style="text-align: right;">12.696</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(temp):bay_segmentMTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">1.548</td>
<td style="text-align: right;">0.214</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(sal):bay_segmentOTB</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.759</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(sal):bay_segmentHB</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">0.663</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(sal):bay_segmentMTB</td>
<td style="text-align: right;">2.744</td>
<td style="text-align: right;">3.470</td>
<td style="text-align: right;">4.907</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(mo):bay_segmentOTB</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">8.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.863</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(mo):bay_segmentHB</td>
<td style="text-align: right;">5.790</td>
<td style="text-align: right;">8.000</td>
<td style="text-align: right;">7.157</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(mo):bay_segmentMTB</td>
<td style="text-align: right;">3.140</td>
<td style="text-align: right;">8.000</td>
<td style="text-align: right;">1.236</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(yr,mo):bay_segmentOTB</td>
<td style="text-align: right;">1.016</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.167</td>
<td style="text-align: right;">0.132</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(yr,mo):bay_segmentHB</td>
<td style="text-align: right;">1.530</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: left;"><span class="math inline">\(^.\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(yr,mo):bay_segmentMTB</td>
<td style="text-align: right;">2.022</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.213</td>
<td style="text-align: right;">0.242</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(la,mo):bay_segmentOTB</td>
<td style="text-align: right;">0.435</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">0.272</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(la,mo):bay_segmentHB</td>
<td style="text-align: right;">0.119</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.339</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(la,mo):bay_segmentMTB</td>
<td style="text-align: right;">3.091</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.495</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: left;"><span class="math inline">\(^.\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(temp,mo):bay_segmentOTB</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.572</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(temp,mo):bay_segmentHB</td>
<td style="text-align: right;">4.526</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">41.642</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(temp,mo):bay_segmentMTB</td>
<td style="text-align: right;">1.568</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.385</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(sal,mo):bay_segmentOTB</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.901</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(sal,mo):bay_segmentHB</td>
<td style="text-align: right;">0.282</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">0.294</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(sal,mo):bay_segmentMTB</td>
<td style="text-align: right;">1.422</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.357</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: left;">*</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Model fit summary:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>smmod <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>smtab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">R.sq =</span> smmod<span class="sc">$</span>r.sq,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Deviance explained</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>smmod<span class="sc">$</span>dev.expl, <span class="dv">0</span>), <span class="st">'%'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(smtab, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">'l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">R.sq</th>
<th style="text-align: left;">Deviance explained</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.48</td>
<td style="text-align: left;">51%</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Select smoothers:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'s(temp)'</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="gam_exploration_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="768"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'s(sal)'</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-13-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="gam_exploration_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="768"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'ti(temp,mo)'</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="gam_exploration_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'ti(sal,mo)'</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-14-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="gam_exploration_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
</div>
<p>Model slices for interaction terms:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>tempslc <span class="ot">&lt;-</span> <span class="fu">smooth_estimates</span>(mod, <span class="at">select =</span> <span class="st">'ti(temp,mo)'</span>, <span class="at">partial_match =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confint</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bay_segment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'HB'</span>, <span class="st">'MTB'</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tempslc, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> .estimate, <span class="at">color =</span> <span class="fu">factor</span>(mo), <span class="at">fill =</span> <span class="fu">factor</span>(mo), <span class="at">group =</span> mo)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower_ci, <span class="at">ymax =</span> .upper_ci), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>bay_segment, <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Temperature'</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Partial effect'</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'Month'</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">'Month'</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="gam_exploration_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>salslc <span class="ot">&lt;-</span> <span class="fu">smooth_estimates</span>(mod, <span class="at">select =</span> <span class="st">'ti(sal,mo)'</span>, <span class="at">partial_match =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confint</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bay_segment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'MTB'</span>))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(salslc, <span class="fu">aes</span>(<span class="at">x =</span> sal, <span class="at">y =</span> .estimate, <span class="at">color =</span> <span class="fu">factor</span>(mo), <span class="at">fill =</span> <span class="fu">factor</span>(mo), <span class="at">group =</span> mo)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower_ci, <span class="at">ymax =</span> .upper_ci), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>bay_segment, <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Salinity'</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Partial effect'</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'Month'</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">'Month'</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="gam_exploration_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="384"></a></p>
</figure>
</div>
</div>
</div>
<section id="conclusions-1" class="level3">
<h3 class="anchored" data-anchor-id="conclusions-1">Conclusions</h3>
<p>The FIM models are more promising as expected relationships with temperature and salinity are observed, particularly for MTB and HB. There are also interesting interactions by month suggesting the effects vary seasonally, e.g., the temperature effect in HB seems to be driven by July temperatures and the salinity effect in MTB seems to be pronounced in the dry season (March).</p>
</section>
</section>
<section id="pdem" class="level2">
<h2 class="anchored" data-anchor-id="pdem">PDEM</h2>
<p>The PDEM models are similar to the FIM models except only OTB is evaluated. Effects are also evaluated differently for four sampling strata in OTB (E1-E4, somewhat north to south), allowing for a more precise spatial assessment of seagrass relationships. The data are averaged for each year, month, and stratum. Compared to the FIM data, fewer Secchi measurements were on the bottom given the broader depth coverage (see Figure 1 in the manuscript). Additionally, PDEM only records seagrass presence/absence, but this was converted to a strata-wide frequency occurrence metric as the number of points with seagrass divided by the total points in each stratum.</p>
<p>The PDEM model is the same as for FIM, except separate smoothers are estimated for each stratum instead of bay segment. The model formula is as follows:</p>
<p><span class="math display">\[
\begin{aligned}
Freq. Occ. \sim s(year, by = stratum, bs = 'tp') + s(la, by = stratum, bs = 'tp') +
\\
s(temp, by = stratum, bs = 'tp') + s(salinity, by = stratum, bs = 'tp') +
\\
s(month, bs = 'cc', by = stratum) +
\\
ti(year, month, bs = c('tp', 'cc'), by = stratum) +
\\
ti(la, month, bs = c('tp', 'cc'), by = stratum) +
\\
ti(temp, month, bs = c('tp', 'cc'), by = stratum) +
\\
ti(salinity, month, bs = c('tp', 'cc'), by = stratum)
\end{aligned}
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tomod <span class="ot">&lt;-</span> pincotemp <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>bay_segment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'LTB'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, allsg, yr, site, temp, sal, secchi_m, secchi_on_bottom, bay_segment) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mo =</span> <span class="fu">month</span>(date),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">site =</span> <span class="fu">factor</span>(site)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">allsg =</span> <span class="fu">sum</span>(allsg) <span class="sc">/</span> <span class="fu">length</span>(allsg),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">mean</span>(temp),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sal =</span> <span class="fu">mean</span>(sal),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">secchi_m =</span> <span class="fu">mean</span>(secchi_m),</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(yr, mo, site)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">la =</span> <span class="fl">1.49</span> <span class="sc">/</span> secchi_m</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(allsg <span class="sc">~</span> <span class="fu">s</span>(yr, <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">s</span>(la, <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">s</span>(temp, <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">s</span>(sal, <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">s</span>(mo, <span class="at">bs =</span> <span class="st">'cc'</span>, <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">ti</span>(yr, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">ti</span>(la, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">ti</span>(temp, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">ti</span>(sal, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> site), <span class="at">knots =</span> <span class="fu">list</span>(<span class="at">doy =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">12</span>)), <span class="at">data =</span> tomod, <span class="at">method =</span> <span class="st">'REML'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Smoother summary:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">star =</span> <span class="fu">p_ast2</span>(p.value)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">edf</th>
<th style="text-align: right;">ref.df</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: left;">star</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">s(yr):siteE1</td>
<td style="text-align: right;">2.007</td>
<td style="text-align: right;">2.482</td>
<td style="text-align: right;">1.371</td>
<td style="text-align: right;">0.320</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(yr):siteE2</td>
<td style="text-align: right;">2.231</td>
<td style="text-align: right;">2.760</td>
<td style="text-align: right;">1.772</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(yr):siteE3</td>
<td style="text-align: right;">2.908</td>
<td style="text-align: right;">3.604</td>
<td style="text-align: right;">2.568</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(yr):siteE4</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">2.961</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: left;"><span class="math inline">\(^.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(la):siteE1</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">2.742</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: left;"><span class="math inline">\(^.\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(la):siteE2</td>
<td style="text-align: right;">2.129</td>
<td style="text-align: right;">2.650</td>
<td style="text-align: right;">2.693</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: left;"><span class="math inline">\(^.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(la):siteE3</td>
<td style="text-align: right;">4.498</td>
<td style="text-align: right;">5.225</td>
<td style="text-align: right;">4.398</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(la):siteE4</td>
<td style="text-align: right;">2.800</td>
<td style="text-align: right;">3.397</td>
<td style="text-align: right;">8.141</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(temp):siteE1</td>
<td style="text-align: right;">1.532</td>
<td style="text-align: right;">1.888</td>
<td style="text-align: right;">0.426</td>
<td style="text-align: right;">0.618</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(temp):siteE2</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.843</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(temp):siteE3</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.601</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(temp):siteE4</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.246</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(sal):siteE1</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">2.928</td>
<td style="text-align: right;">0.088</td>
<td style="text-align: left;"><span class="math inline">\(^.\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(sal):siteE2</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.301</td>
<td style="text-align: right;">0.583</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(sal):siteE3</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">1.002</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.861</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(sal):siteE4</td>
<td style="text-align: right;">1.238</td>
<td style="text-align: right;">1.398</td>
<td style="text-align: right;">1.022</td>
<td style="text-align: right;">0.403</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(mo):siteE1</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">8.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.351</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(mo):siteE2</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">8.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.439</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(mo):siteE3</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">8.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.564</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">s(mo):siteE4</td>
<td style="text-align: right;">1.362</td>
<td style="text-align: right;">8.000</td>
<td style="text-align: right;">0.305</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: left;"><span class="math inline">\(^.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(yr,mo):siteE1</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.817</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(yr,mo):siteE2</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.601</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(yr,mo):siteE3</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.481</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(yr,mo):siteE4</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.425</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(la,mo):siteE1</td>
<td style="text-align: right;">0.458</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(la,mo):siteE2</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(la,mo):siteE3</td>
<td style="text-align: right;">3.332</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">1.221</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(la,mo):siteE4</td>
<td style="text-align: right;">4.843</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">1.431</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(temp,mo):siteE1</td>
<td style="text-align: right;">1.777</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(temp,mo):siteE2</td>
<td style="text-align: right;">1.809</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.241</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(temp,mo):siteE3</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.321</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(temp,mo):siteE4</td>
<td style="text-align: right;">1.357</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.357</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(sal,mo):siteE1</td>
<td style="text-align: right;">0.724</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(sal,mo):siteE2</td>
<td style="text-align: right;">1.471</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.204</td>
<td style="text-align: right;">0.143</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(sal,mo):siteE3</td>
<td style="text-align: right;">1.357</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.190</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(sal,mo):siteE4</td>
<td style="text-align: right;">3.638</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">0.694</td>
<td style="text-align: right;">0.019</td>
<td style="text-align: left;">*</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Model fit summary:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>smmod <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>smtab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">R.sq =</span> smmod<span class="sc">$</span>r.sq,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Deviance explained</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>smmod<span class="sc">$</span>dev.expl, <span class="dv">0</span>), <span class="st">'%'</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(smtab, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">'l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">R.sq</th>
<th style="text-align: left;">Deviance explained</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.25</td>
<td style="text-align: left;">32%</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Select smoothers:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'s(temp)'</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="gam_exploration_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="768"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'s(sal)'</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-20-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="gam_exploration_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="768"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'ti(temp,mo)'</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="gam_exploration_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'ti(sal,mo)'</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-21-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="gam_exploration_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
</div>
<p>Model slices for interaction terms:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tempslc <span class="ot">&lt;-</span> <span class="fu">smooth_estimates</span>(mod, <span class="at">select =</span> <span class="st">'ti(temp,mo)'</span>, <span class="at">partial_match =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confint</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'E1'</span>, <span class="st">'E4'</span>))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tempslc, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> .estimate, <span class="at">color =</span> <span class="fu">factor</span>(mo), <span class="at">fill =</span> <span class="fu">factor</span>(mo), <span class="at">group =</span> mo)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower_ci, <span class="at">ymax =</span> .upper_ci), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site, <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Temperature'</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Partial effect'</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'Month'</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">'Month'</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="gam_exploration_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>salslc <span class="ot">&lt;-</span> <span class="fu">smooth_estimates</span>(mod, <span class="at">select =</span> <span class="st">'ti(sal,mo)'</span>, <span class="at">partial_match =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confint</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'E4'</span>))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(salslc, <span class="fu">aes</span>(<span class="at">x =</span> sal, <span class="at">y =</span> .estimate, <span class="at">color =</span> <span class="fu">factor</span>(mo), <span class="at">fill =</span> <span class="fu">factor</span>(mo), <span class="at">group =</span> mo)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower_ci, <span class="at">ymax =</span> .upper_ci), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site, <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Salinity'</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Partial effect'</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'Month'</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">'Month'</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="gam_exploration_files/figure-html/unnamed-chunk-23-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="gam_exploration_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="384"></a></p>
</figure>
</div>
</div>
</div>
<section id="conclusions-2" class="level3">
<h3 class="anchored" data-anchor-id="conclusions-2">Conclusions</h3>
<p>None of the main effects for temperature or salinity are significant, although Some of the interaction terms by stratum are informative. The model slices for salinity at stratum E4 and temperature at E1 are unclear, but temperature at E4 is associated with lower frequency occurrence of seagrass in January.</p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb28" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "GAM exploration"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">   - lightbox</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> auto</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gratia)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'R/funcs.R'</span>))</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">'data/epccmbdat.RData'</span>))</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">'data/fimsgtempdat.RData'</span>))</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">'data/pincotemp.RData'</span>))</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>The following is an exploratory analysis of potential seagrass response related to time, light attenuation, temperature, and salinity. Three different datasets are used, each with different sampling designs. GAMs are used to assess potential non-linear responses in seagrass change using the sum of additive smoothing functions for different predictors. Lower Tampa Bay is not modeled in any of the models given minimal seagrass loss.  Model selection techniques are not considered for simplicity and the results are evaluated based on the percent deviance explained and "partial effects" of each smoother, where the smoother is a proxy for the effect of the variable on the response while considering a more comprehensive set of predictors.  These models were developed in response to reviewer comments on including additional predictors important for characterizing change, namely time and light attenuation. </span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quick summary</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>All models had much more explained variance (32-94%) compared to earlier linear regression models. The EPC models returned confusing results, which could be from differences in sampling location for water quality (mid-bay) vs seagrass transect sampling.  The FIM models for nearshore provide the most compelling results, particularly for temperature in HB and salinity in MTB.  There are also some notable differences by season in the FIM models.  The PDEM models are inconsistent, although a significant interaction term for temperature and season at stratum E4 (most southern portion of OTB) suggests increasing temperature in the winter is associated with lower seagrass frequency occurrence.  In general, trends in OTB are not explained well by temperature or salinity, whereas HB and MTB follow expectations for some of the models.</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a><span class="fu">## EPC</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>The EPC data were compared to bay segment averages of seagrass transect frequency occurrence data at the annual scale. Light attenuation was estimated from all monitoring stations using Secchi depth and combined as a bay segment average, as is done for TBEP reporting to FDEP. Temperature and salinity are expressed as the estimated number of days each year when when temperature was above or salinity was below a threshold, where the expectation is that total frequency occurrence will decrease as both increase. The model formula is as follows:</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>Freq. Occ. \sim s(year, by = bay<span class="sc">\_</span>segment, bs = 'tp') + s(la, by = bay<span class="sc">\_</span>segment, bs = 'tp') + </span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>s(temp, by = bay<span class="sc">\_</span>segment, bs = 'tp') + s(salinity, by = bay<span class="sc">\_</span>segment, bs = 'tp')</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>tomod <span class="ot">&lt;-</span> epccmbdat <span class="sc">%&gt;%</span> </span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>bay_segment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'LTB'</span>))</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a><span class="co"># single smoothers only, temp, sal</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(total <span class="sc">~</span> <span class="fu">s</span>(yr, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(la, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(temp, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(sal, <span class="at">by =</span> bay_segment), <span class="at">data =</span> tomod, <span class="at">method =</span> <span class="st">'REML'</span>)</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>Smoother summary:</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> </span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">star =</span> <span class="fu">p_ast2</span>(p.value)</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>Model fit summary:</span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>smmod <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)</span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>smtab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">R.sq =</span> smmod<span class="sc">$</span>r.sq,</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Deviance explained</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>smmod<span class="sc">$</span>dev.expl, <span class="dv">0</span>), <span class="st">'%'</span>)</span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(smtab, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">'l'</span>)</span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>The same model is created but the "both" metric is used instead of temperature and salinity, which is the number of days each year when both temperature was above or salinity was below thresholds.  The expectation is that total frequency occurrence will decrease as the metric increases, either linearly (additive effect) or non-linearly (multiplicative effect). The model formula is as follows:</span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>Freq. Occ. \sim s(year, by = bay<span class="sc">\_</span>segment, bs = 'tp') + s(la, by = bay<span class="sc">\_</span>segment, bs = 'tp') + </span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a>s(both, by = bay<span class="sc">\_</span>segment, bs = 'tp')</span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a><span class="co"># single smoothers only, temp, sal</span></span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(total <span class="sc">~</span> <span class="fu">s</span>(yr, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(la, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(both, <span class="at">by =</span> bay_segment), <span class="at">data =</span> tomod, <span class="at">method =</span> <span class="st">'REML'</span>)</span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a>Smoother summary: </span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> </span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">star =</span> <span class="fu">p_ast2</span>(p.value)</span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a>Model fit summary:</span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a>smmod <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)</span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a>smtab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">R.sq =</span> smmod<span class="sc">$</span>r.sq,</span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Deviance explained</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>smmod<span class="sc">$</span>dev.expl, <span class="dv">0</span>), <span class="st">'%'</span>)</span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(smtab, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">'l'</span>)</span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 7.5</span></span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusions</span></span>
<span id="cb28-156"><a href="#cb28-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-157"><a href="#cb28-157" aria-hidden="true" tabindex="-1"></a>There's some weirdness with these models that don't align with expectations.  For example, increasing light attenuation is associated with increasing seagrass frequency occurrence (MTB).  Additionally, increases of the stressor metrics are also often associated with increasing seagrass frequency occurrence. These results could be from a discrepancy between sampling location of the EPC stations and the seagrass transects, i.e., the stations are in deeper water and may not reflect conditions at the seagrass beds in more shallow waters. The association of the salinity metric with seagrasses in MTB is as expected, although the smoother is not significant.  However, this is consistent with the FIM models.</span>
<span id="cb28-158"><a href="#cb28-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-159"><a href="#cb28-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## FIM</span></span>
<span id="cb28-160"><a href="#cb28-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-161"><a href="#cb28-161" aria-hidden="true" tabindex="-1"></a>The FIM models are different from the EPC models in several ways: </span>
<span id="cb28-162"><a href="#cb28-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-163"><a href="#cb28-163" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Seagrass and stressor data are collected at the same locations possibly allowing for a more consistent comparison</span>
<span id="cb28-164"><a href="#cb28-164" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The stressor data (light attenuation, temperature, salinity) are observed data, so the expectation of how seagrass will response varies from the EPC data and by stressor, i.e., seagrass will decrease with temperature and light attenuation, but increase with salinity (fresh conditions are more stressful)</span>
<span id="cb28-165"><a href="#cb28-165" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Monthly observations are available, allowing a seasonal component in the model. </span>
<span id="cb28-166"><a href="#cb28-166" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Secchi data is used for light attenuation (as for EPC), but more than half of the observations are on the bottom.  Attempts were made to calculate monthly medians using Kaplan-Meier survival curves, but data were insufficient to do so.</span>
<span id="cb28-167"><a href="#cb28-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-168"><a href="#cb28-168" aria-hidden="true" tabindex="-1"></a>The FIM data are averaged at the annual and monthly time steps. The model is more complex than the previous and includes smoothers for year, month, light attenuation, temperature, and salinity and interaction smoothers (<span class="in">`ti`</span>) for the predictions with month, allowing the effects of the predictors to vary seasonally. Different smoothers are also constructed for each bay segment. The model formula is as follows:</span>
<span id="cb28-169"><a href="#cb28-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-170"><a href="#cb28-170" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-171"><a href="#cb28-171" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb28-172"><a href="#cb28-172" aria-hidden="true" tabindex="-1"></a>Coverage \sim s(year, by = bay<span class="sc">\_</span>segment, bs = 'tp') + s(la, by = bay<span class="sc">\_</span>segment, bs = 'tp') + </span>
<span id="cb28-173"><a href="#cb28-173" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-174"><a href="#cb28-174" aria-hidden="true" tabindex="-1"></a>s(temp, by = bay<span class="sc">\_</span>segment, bs = 'tp') + s(salinity, by = bay<span class="sc">\_</span>segment, bs = 'tp') +</span>
<span id="cb28-175"><a href="#cb28-175" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-176"><a href="#cb28-176" aria-hidden="true" tabindex="-1"></a>s(month, bs = 'cc', by = bay<span class="sc">\_</span>segment) + </span>
<span id="cb28-177"><a href="#cb28-177" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-178"><a href="#cb28-178" aria-hidden="true" tabindex="-1"></a>ti(year, month, bs = c('tp', 'cc'), by = bay<span class="sc">\_</span>segment) + </span>
<span id="cb28-179"><a href="#cb28-179" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-180"><a href="#cb28-180" aria-hidden="true" tabindex="-1"></a>ti(la, month, bs = c('tp', 'cc'), by = bay<span class="sc">\_</span>segment) + </span>
<span id="cb28-181"><a href="#cb28-181" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-182"><a href="#cb28-182" aria-hidden="true" tabindex="-1"></a>ti(temp, month, bs = c('tp', 'cc'), by = bay<span class="sc">\_</span>segment) +</span>
<span id="cb28-183"><a href="#cb28-183" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-184"><a href="#cb28-184" aria-hidden="true" tabindex="-1"></a>ti(salinity, month, bs = c('tp', 'cc'), by = bay<span class="sc">\_</span>segment)</span>
<span id="cb28-185"><a href="#cb28-185" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb28-186"><a href="#cb28-186" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-187"><a href="#cb28-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-190"><a href="#cb28-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-191"><a href="#cb28-191" aria-hidden="true" tabindex="-1"></a>tomod <span class="ot">&lt;-</span> fimsgtempdat <span class="sc">%&gt;%</span> </span>
<span id="cb28-192"><a href="#cb28-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>bay_segment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'LTB'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-193"><a href="#cb28-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, sgcov, sgpres, yr, temp, sal, secchi_m, secchi_on_bottom, bay_segment) <span class="sc">%&gt;%</span> </span>
<span id="cb28-194"><a href="#cb28-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-195"><a href="#cb28-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mo =</span> <span class="fu">month</span>(date)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-196"><a href="#cb28-196" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(month(date) %in% c(6:9)) %&gt;%</span></span>
<span id="cb28-197"><a href="#cb28-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb28-198"><a href="#cb28-198" aria-hidden="true" tabindex="-1"></a>    <span class="at">sgcov =</span> <span class="fu">mean</span>(sgcov),</span>
<span id="cb28-199"><a href="#cb28-199" aria-hidden="true" tabindex="-1"></a>    <span class="at">sgpres =</span> <span class="fu">mean</span>(sgpres),</span>
<span id="cb28-200"><a href="#cb28-200" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">mean</span>(temp),</span>
<span id="cb28-201"><a href="#cb28-201" aria-hidden="true" tabindex="-1"></a>    <span class="at">sal =</span> <span class="fu">mean</span>(sal),</span>
<span id="cb28-202"><a href="#cb28-202" aria-hidden="true" tabindex="-1"></a>    <span class="at">secchi_m =</span> <span class="fu">mean</span>(secchi_m),</span>
<span id="cb28-203"><a href="#cb28-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(bay_segment, yr, mo)</span>
<span id="cb28-204"><a href="#cb28-204" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb28-205"><a href="#cb28-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-206"><a href="#cb28-206" aria-hidden="true" tabindex="-1"></a>    <span class="at">la =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb28-207"><a href="#cb28-207" aria-hidden="true" tabindex="-1"></a>      bay_segment <span class="sc">%in%</span> <span class="st">"OTB"</span> <span class="sc">~</span> <span class="fl">1.49</span> <span class="sc">/</span> secchi_m,</span>
<span id="cb28-208"><a href="#cb28-208" aria-hidden="true" tabindex="-1"></a>      bay_segment <span class="sc">%in%</span> <span class="st">"HB"</span> <span class="sc">~</span> <span class="fl">1.61</span> <span class="sc">/</span> secchi_m,</span>
<span id="cb28-209"><a href="#cb28-209" aria-hidden="true" tabindex="-1"></a>      bay_segment <span class="sc">%in%</span> <span class="st">"MTB"</span> <span class="sc">~</span> <span class="fl">1.49</span> <span class="sc">/</span> secchi_m,</span>
<span id="cb28-210"><a href="#cb28-210" aria-hidden="true" tabindex="-1"></a>      bay_segment <span class="sc">%in%</span> <span class="st">"LTB"</span> <span class="sc">~</span> <span class="fl">1.84</span> <span class="sc">/</span> secchi_m</span>
<span id="cb28-211"><a href="#cb28-211" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-212"><a href="#cb28-212" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-213"><a href="#cb28-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-214"><a href="#cb28-214" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(sgcov <span class="sc">~</span> <span class="fu">s</span>(yr, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(la, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(temp, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(sal, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">s</span>(mo, <span class="at">bs =</span> <span class="st">'cc'</span>, <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">ti</span>(yr, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">ti</span>(la, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">ti</span>(temp, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> bay_segment) <span class="sc">+</span> <span class="fu">ti</span>(sal, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> bay_segment), <span class="at">knots =</span> <span class="fu">list</span>(<span class="at">doy =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">12</span>)), <span class="at">data =</span> tomod, <span class="at">method =</span> <span class="st">'REML'</span>)</span>
<span id="cb28-215"><a href="#cb28-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-216"><a href="#cb28-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-217"><a href="#cb28-217" aria-hidden="true" tabindex="-1"></a>Smoother summary: </span>
<span id="cb28-218"><a href="#cb28-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-221"><a href="#cb28-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-222"><a href="#cb28-222" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> </span>
<span id="cb28-223"><a href="#cb28-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-224"><a href="#cb28-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-225"><a href="#cb28-225" aria-hidden="true" tabindex="-1"></a>    <span class="at">star =</span> <span class="fu">p_ast2</span>(p.value)</span>
<span id="cb28-226"><a href="#cb28-226" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb28-227"><a href="#cb28-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb28-228"><a href="#cb28-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-229"><a href="#cb28-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-230"><a href="#cb28-230" aria-hidden="true" tabindex="-1"></a>Model fit summary: </span>
<span id="cb28-231"><a href="#cb28-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-234"><a href="#cb28-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-235"><a href="#cb28-235" aria-hidden="true" tabindex="-1"></a>smmod <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)</span>
<span id="cb28-236"><a href="#cb28-236" aria-hidden="true" tabindex="-1"></a>smtab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb28-237"><a href="#cb28-237" aria-hidden="true" tabindex="-1"></a>  <span class="at">R.sq =</span> smmod<span class="sc">$</span>r.sq,</span>
<span id="cb28-238"><a href="#cb28-238" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Deviance explained</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>smmod<span class="sc">$</span>dev.expl, <span class="dv">0</span>), <span class="st">'%'</span>)</span>
<span id="cb28-239"><a href="#cb28-239" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-240"><a href="#cb28-240" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(smtab, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">'l'</span>)</span>
<span id="cb28-241"><a href="#cb28-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-242"><a href="#cb28-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-243"><a href="#cb28-243" aria-hidden="true" tabindex="-1"></a>Select smoothers:</span>
<span id="cb28-244"><a href="#cb28-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-247"><a href="#cb28-247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-248"><a href="#cb28-248" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb28-249"><a href="#cb28-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb28-250"><a href="#cb28-250" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'s(temp)'</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-251"><a href="#cb28-251" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'s(sal)'</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-252"><a href="#cb28-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-255"><a href="#cb28-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-256"><a href="#cb28-256" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb28-257"><a href="#cb28-257" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb28-258"><a href="#cb28-258" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'ti(temp,mo)'</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-259"><a href="#cb28-259" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'ti(sal,mo)'</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-260"><a href="#cb28-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-261"><a href="#cb28-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-262"><a href="#cb28-262" aria-hidden="true" tabindex="-1"></a>Model slices for interaction terms:</span>
<span id="cb28-263"><a href="#cb28-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-266"><a href="#cb28-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-267"><a href="#cb28-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb28-268"><a href="#cb28-268" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb28-269"><a href="#cb28-269" aria-hidden="true" tabindex="-1"></a>tempslc <span class="ot">&lt;-</span> <span class="fu">smooth_estimates</span>(mod, <span class="at">select =</span> <span class="st">'ti(temp,mo)'</span>, <span class="at">partial_match =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb28-270"><a href="#cb28-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confint</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-271"><a href="#cb28-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-272"><a href="#cb28-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bay_segment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'HB'</span>, <span class="st">'MTB'</span>))</span>
<span id="cb28-273"><a href="#cb28-273" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tempslc, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> .estimate, <span class="at">color =</span> <span class="fu">factor</span>(mo), <span class="at">fill =</span> <span class="fu">factor</span>(mo), <span class="at">group =</span> mo)) <span class="sc">+</span></span>
<span id="cb28-274"><a href="#cb28-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower_ci, <span class="at">ymax =</span> .upper_ci), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb28-275"><a href="#cb28-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb28-276"><a href="#cb28-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>bay_segment, <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb28-277"><a href="#cb28-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-278"><a href="#cb28-278" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Temperature'</span>,</span>
<span id="cb28-279"><a href="#cb28-279" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Partial effect'</span>,</span>
<span id="cb28-280"><a href="#cb28-280" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'Month'</span>,</span>
<span id="cb28-281"><a href="#cb28-281" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">'Month'</span></span>
<span id="cb28-282"><a href="#cb28-282" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-283"><a href="#cb28-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-286"><a href="#cb28-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-287"><a href="#cb28-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb28-288"><a href="#cb28-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb28-289"><a href="#cb28-289" aria-hidden="true" tabindex="-1"></a>salslc <span class="ot">&lt;-</span> <span class="fu">smooth_estimates</span>(mod, <span class="at">select =</span> <span class="st">'ti(sal,mo)'</span>, <span class="at">partial_match =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb28-290"><a href="#cb28-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confint</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-291"><a href="#cb28-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-292"><a href="#cb28-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bay_segment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'MTB'</span>))</span>
<span id="cb28-293"><a href="#cb28-293" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(salslc, <span class="fu">aes</span>(<span class="at">x =</span> sal, <span class="at">y =</span> .estimate, <span class="at">color =</span> <span class="fu">factor</span>(mo), <span class="at">fill =</span> <span class="fu">factor</span>(mo), <span class="at">group =</span> mo)) <span class="sc">+</span></span>
<span id="cb28-294"><a href="#cb28-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower_ci, <span class="at">ymax =</span> .upper_ci), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb28-295"><a href="#cb28-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb28-296"><a href="#cb28-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>bay_segment, <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb28-297"><a href="#cb28-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-298"><a href="#cb28-298" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Salinity'</span>,</span>
<span id="cb28-299"><a href="#cb28-299" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Partial effect'</span>,</span>
<span id="cb28-300"><a href="#cb28-300" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'Month'</span>,</span>
<span id="cb28-301"><a href="#cb28-301" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">'Month'</span></span>
<span id="cb28-302"><a href="#cb28-302" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-303"><a href="#cb28-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-304"><a href="#cb28-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-305"><a href="#cb28-305" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusions</span></span>
<span id="cb28-306"><a href="#cb28-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-307"><a href="#cb28-307" aria-hidden="true" tabindex="-1"></a>The FIM models are more promising as expected relationships with temperature and salinity are observed, particularly for MTB and HB.  There are also interesting interactions by month suggesting the effects vary seasonally, e.g., the temperature effect in HB seems to be driven by July temperatures and the salinity effect in MTB seems to be pronounced in the dry season (March). </span>
<span id="cb28-308"><a href="#cb28-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-309"><a href="#cb28-309" aria-hidden="true" tabindex="-1"></a><span class="fu">## PDEM</span></span>
<span id="cb28-310"><a href="#cb28-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-311"><a href="#cb28-311" aria-hidden="true" tabindex="-1"></a>The PDEM models are similar to the FIM models except only OTB is evaluated. Effects are also evaluated differently for four sampling strata in OTB (E1-E4, somewhat north to south), allowing for a more precise spatial assessment of seagrass relationships. The data are averaged for each year, month, and stratum.  Compared to the FIM data, fewer Secchi measurements were on the bottom given the broader depth coverage (see Figure 1 in the manuscript).  Additionally, PDEM only records seagrass presence/absence, but this was converted to a strata-wide frequency occurrence metric as the number of points with seagrass divided by the total points in each stratum.</span>
<span id="cb28-312"><a href="#cb28-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-313"><a href="#cb28-313" aria-hidden="true" tabindex="-1"></a>The PDEM model is the same as for FIM, except separate smoothers are estimated for each stratum instead of bay segment. The model formula is as follows:</span>
<span id="cb28-314"><a href="#cb28-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-315"><a href="#cb28-315" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-316"><a href="#cb28-316" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb28-317"><a href="#cb28-317" aria-hidden="true" tabindex="-1"></a>Freq. Occ. \sim s(year, by = stratum, bs = 'tp') + s(la, by = stratum, bs = 'tp') + </span>
<span id="cb28-318"><a href="#cb28-318" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-319"><a href="#cb28-319" aria-hidden="true" tabindex="-1"></a>s(temp, by = stratum, bs = 'tp') + s(salinity, by = stratum, bs = 'tp') +</span>
<span id="cb28-320"><a href="#cb28-320" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-321"><a href="#cb28-321" aria-hidden="true" tabindex="-1"></a>s(month, bs = 'cc', by = stratum) + </span>
<span id="cb28-322"><a href="#cb28-322" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-323"><a href="#cb28-323" aria-hidden="true" tabindex="-1"></a>ti(year, month, bs = c('tp', 'cc'), by = stratum) + </span>
<span id="cb28-324"><a href="#cb28-324" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-325"><a href="#cb28-325" aria-hidden="true" tabindex="-1"></a>ti(la, month, bs = c('tp', 'cc'), by = stratum) + </span>
<span id="cb28-326"><a href="#cb28-326" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-327"><a href="#cb28-327" aria-hidden="true" tabindex="-1"></a>ti(temp, month, bs = c('tp', 'cc'), by = stratum) +</span>
<span id="cb28-328"><a href="#cb28-328" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb28-329"><a href="#cb28-329" aria-hidden="true" tabindex="-1"></a>ti(salinity, month, bs = c('tp', 'cc'), by = stratum)</span>
<span id="cb28-330"><a href="#cb28-330" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb28-331"><a href="#cb28-331" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-334"><a href="#cb28-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-335"><a href="#cb28-335" aria-hidden="true" tabindex="-1"></a>tomod <span class="ot">&lt;-</span> pincotemp <span class="sc">%&gt;%</span> </span>
<span id="cb28-336"><a href="#cb28-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>bay_segment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'LTB'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-337"><a href="#cb28-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, allsg, yr, site, temp, sal, secchi_m, secchi_on_bottom, bay_segment) <span class="sc">%&gt;%</span> </span>
<span id="cb28-338"><a href="#cb28-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-339"><a href="#cb28-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-340"><a href="#cb28-340" aria-hidden="true" tabindex="-1"></a>    <span class="at">mo =</span> <span class="fu">month</span>(date),</span>
<span id="cb28-341"><a href="#cb28-341" aria-hidden="true" tabindex="-1"></a>    <span class="at">site =</span> <span class="fu">factor</span>(site)</span>
<span id="cb28-342"><a href="#cb28-342" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb28-343"><a href="#cb28-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb28-344"><a href="#cb28-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">allsg =</span> <span class="fu">sum</span>(allsg) <span class="sc">/</span> <span class="fu">length</span>(allsg),</span>
<span id="cb28-345"><a href="#cb28-345" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">mean</span>(temp),</span>
<span id="cb28-346"><a href="#cb28-346" aria-hidden="true" tabindex="-1"></a>    <span class="at">sal =</span> <span class="fu">mean</span>(sal),</span>
<span id="cb28-347"><a href="#cb28-347" aria-hidden="true" tabindex="-1"></a>    <span class="at">secchi_m =</span> <span class="fu">mean</span>(secchi_m),</span>
<span id="cb28-348"><a href="#cb28-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(yr, mo, site)</span>
<span id="cb28-349"><a href="#cb28-349" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb28-350"><a href="#cb28-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-351"><a href="#cb28-351" aria-hidden="true" tabindex="-1"></a>    <span class="at">la =</span> <span class="fl">1.49</span> <span class="sc">/</span> secchi_m</span>
<span id="cb28-352"><a href="#cb28-352" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-353"><a href="#cb28-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-354"><a href="#cb28-354" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(allsg <span class="sc">~</span> <span class="fu">s</span>(yr, <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">s</span>(la, <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">s</span>(temp, <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">s</span>(sal, <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">s</span>(mo, <span class="at">bs =</span> <span class="st">'cc'</span>, <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">ti</span>(yr, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">ti</span>(la, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">ti</span>(temp, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> site) <span class="sc">+</span> <span class="fu">ti</span>(sal, mo, <span class="at">bs =</span> <span class="fu">c</span>(<span class="st">'tp'</span>, <span class="st">'cc'</span>), <span class="at">by =</span> site), <span class="at">knots =</span> <span class="fu">list</span>(<span class="at">doy =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">12</span>)), <span class="at">data =</span> tomod, <span class="at">method =</span> <span class="st">'REML'</span>)</span>
<span id="cb28-355"><a href="#cb28-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-356"><a href="#cb28-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-357"><a href="#cb28-357" aria-hidden="true" tabindex="-1"></a>Smoother summary: </span>
<span id="cb28-358"><a href="#cb28-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-361"><a href="#cb28-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-362"><a href="#cb28-362" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> </span>
<span id="cb28-363"><a href="#cb28-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-364"><a href="#cb28-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-365"><a href="#cb28-365" aria-hidden="true" tabindex="-1"></a>    <span class="at">star =</span> <span class="fu">p_ast2</span>(p.value)</span>
<span id="cb28-366"><a href="#cb28-366" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb28-367"><a href="#cb28-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb28-368"><a href="#cb28-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-369"><a href="#cb28-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-370"><a href="#cb28-370" aria-hidden="true" tabindex="-1"></a>Model fit summary: </span>
<span id="cb28-371"><a href="#cb28-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-374"><a href="#cb28-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-375"><a href="#cb28-375" aria-hidden="true" tabindex="-1"></a>smmod <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)</span>
<span id="cb28-376"><a href="#cb28-376" aria-hidden="true" tabindex="-1"></a>smtab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb28-377"><a href="#cb28-377" aria-hidden="true" tabindex="-1"></a>  <span class="at">R.sq =</span> smmod<span class="sc">$</span>r.sq,</span>
<span id="cb28-378"><a href="#cb28-378" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Deviance explained</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>smmod<span class="sc">$</span>dev.expl, <span class="dv">0</span>), <span class="st">'%'</span>)</span>
<span id="cb28-379"><a href="#cb28-379" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-380"><a href="#cb28-380" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(smtab, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">'l'</span>)</span>
<span id="cb28-381"><a href="#cb28-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-382"><a href="#cb28-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-383"><a href="#cb28-383" aria-hidden="true" tabindex="-1"></a>Select smoothers:</span>
<span id="cb28-384"><a href="#cb28-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-387"><a href="#cb28-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-388"><a href="#cb28-388" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb28-389"><a href="#cb28-389" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb28-390"><a href="#cb28-390" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'s(temp)'</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-391"><a href="#cb28-391" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'s(sal)'</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-392"><a href="#cb28-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-395"><a href="#cb28-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-396"><a href="#cb28-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb28-397"><a href="#cb28-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb28-398"><a href="#cb28-398" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'ti(temp,mo)'</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-399"><a href="#cb28-399" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(mod, <span class="at">select =</span> <span class="st">'ti(sal,mo)'</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">partial_match =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-400"><a href="#cb28-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-401"><a href="#cb28-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-402"><a href="#cb28-402" aria-hidden="true" tabindex="-1"></a>Model slices for interaction terms:</span>
<span id="cb28-403"><a href="#cb28-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-406"><a href="#cb28-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-407"><a href="#cb28-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb28-408"><a href="#cb28-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb28-409"><a href="#cb28-409" aria-hidden="true" tabindex="-1"></a>tempslc <span class="ot">&lt;-</span> <span class="fu">smooth_estimates</span>(mod, <span class="at">select =</span> <span class="st">'ti(temp,mo)'</span>, <span class="at">partial_match =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb28-410"><a href="#cb28-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confint</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-411"><a href="#cb28-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-412"><a href="#cb28-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'E1'</span>, <span class="st">'E4'</span>))</span>
<span id="cb28-413"><a href="#cb28-413" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tempslc, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> .estimate, <span class="at">color =</span> <span class="fu">factor</span>(mo), <span class="at">fill =</span> <span class="fu">factor</span>(mo), <span class="at">group =</span> mo)) <span class="sc">+</span></span>
<span id="cb28-414"><a href="#cb28-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower_ci, <span class="at">ymax =</span> .upper_ci), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb28-415"><a href="#cb28-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb28-416"><a href="#cb28-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site, <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb28-417"><a href="#cb28-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-418"><a href="#cb28-418" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Temperature'</span>,</span>
<span id="cb28-419"><a href="#cb28-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Partial effect'</span>,</span>
<span id="cb28-420"><a href="#cb28-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'Month'</span>,</span>
<span id="cb28-421"><a href="#cb28-421" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">'Month'</span></span>
<span id="cb28-422"><a href="#cb28-422" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-423"><a href="#cb28-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-426"><a href="#cb28-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-427"><a href="#cb28-427" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb28-428"><a href="#cb28-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb28-429"><a href="#cb28-429" aria-hidden="true" tabindex="-1"></a>salslc <span class="ot">&lt;-</span> <span class="fu">smooth_estimates</span>(mod, <span class="at">select =</span> <span class="st">'ti(sal,mo)'</span>, <span class="at">partial_match =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb28-430"><a href="#cb28-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confint</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-431"><a href="#cb28-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mo <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-432"><a href="#cb28-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'E4'</span>))</span>
<span id="cb28-433"><a href="#cb28-433" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(salslc, <span class="fu">aes</span>(<span class="at">x =</span> sal, <span class="at">y =</span> .estimate, <span class="at">color =</span> <span class="fu">factor</span>(mo), <span class="at">fill =</span> <span class="fu">factor</span>(mo), <span class="at">group =</span> mo)) <span class="sc">+</span></span>
<span id="cb28-434"><a href="#cb28-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower_ci, <span class="at">ymax =</span> .upper_ci), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb28-435"><a href="#cb28-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb28-436"><a href="#cb28-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site, <span class="at">scales =</span> <span class="st">'free_y'</span>) <span class="sc">+</span> </span>
<span id="cb28-437"><a href="#cb28-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-438"><a href="#cb28-438" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Salinity'</span>,</span>
<span id="cb28-439"><a href="#cb28-439" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Partial effect'</span>,</span>
<span id="cb28-440"><a href="#cb28-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'Month'</span>,</span>
<span id="cb28-441"><a href="#cb28-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">'Month'</span></span>
<span id="cb28-442"><a href="#cb28-442" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-443"><a href="#cb28-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-444"><a href="#cb28-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-445"><a href="#cb28-445" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusions</span></span>
<span id="cb28-446"><a href="#cb28-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-447"><a href="#cb28-447" aria-hidden="true" tabindex="-1"></a>None of the main effects for temperature or salinity are significant, although Some of the interaction terms by stratum are informative.  The model slices for salinity at stratum E4 and temperature at E1 are unclear, but temperature at E4 is associated with lower frequency occurrence of seagrass in January. </span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"loop":false,"closeEffect":"zoom","selector":".lightbox","openEffect":"zoom","descPosition":"bottom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>